<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="个人博客">
<meta name="description" content="">
<meta name="theme-color" content="#000">
<title>如何优雅的将中文markdown文件转换为英文markdown文件 | 炼金术士</title>
<link rel="shortcut icon" href="/favicon.ico?v=1610113090054">
<link rel="stylesheet" href="/media/css/pisces.css">
<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/default.css"
  rel="stylesheet">

<link rel="stylesheet" href="/styles/main.css">

<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
  integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
  integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
  integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>





  <meta name="description" content="如何优雅的将中文markdown文件转换为英文markdown文件" />
  <meta name="keywords" content="" />
</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="pisces">
  <header class="header  ">
    <div class="blog-header box-shadow-wrapper bg-color " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="brand">
              <span>炼金术士</span>
            </a>  
          
        </div>
        
          <p class="subtitle">Just do it</p>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-home"></i> 首页
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives/" target="_self">
                  <i class="fa fa-archive"></i> 归档
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tags/" target="_self">
                  <i class="fa fa-tags"></i> 标签
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/post/about/" target="_self">
                  <i class="fa fa-user"></i> 关于
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-address-book"></i> 友情链接
                  
                </a>
              </li>
            
          
          
            <li id="fa_search" class="nav-item">
              <a href="javascript:void(0);">
                <i class="fa fa-search"></i> <span class="language" data-lan="search">搜索</span>
              </a>
            </li>
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout pisces ">
      <div class="section-layout-wrapper">
        

<div class="sidebar">
  
    <div class="sidebar-box box-shadow-wrapper bg-color right-motion" id="sidebar">
      
        <div class="post-list-sidebar">
          <div class="sidebar-title">
            <span id="tocSideBar" class="sidebar-title-item sidebar-title-active language" data-lan="index">文章目录</span>
            <span id="metaSideBar" class="sidebar-title-item language" data-lan="preview">站点概览</span>
          </div>
        </div>
      
      <div class="sidebar-body pisces" id="sidebar_body">
        
          
            <div class="post-side-meta" id="post_side_meta">
              
<div class="sidebar-wrapper box-shadow-wrapper bg-color">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">田宝杰</p>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">3</span>
        <span class="site-item-stat-name language" data-lan="article">文章</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">0</span>
        <span class="site-item-stat-name language" data-lan="category">分类</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">0</span>
        <span class="site-item-stat-name language" data-lan="tag">标签</span>
      </a>
    </div>
  </div>
  
    
  
  



</div>
            </div>
            <div class="post-toc sidebar-body-active" id="post_toc" style="opacity: 1;">
              <div class="toc-box right-motion">
  <div class="toc-wrapper auto-number auto"
    id="toc_wrapper">
    <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#1-%E6%B3%A8%E5%86%8C%E6%88%90%E4%B8%BA%E7%99%BE%E5%BA%A6%E7%BF%BB%E8%AF%91%E5%BC%80%E5%8F%91%E8%80%85">1. 注册成为百度翻译开发者</a></li>
<li><a href="#2-%E5%88%A9%E7%94%A8%E7%99%BE%E5%BA%A6%E7%BF%BB%E8%AF%91api%E5%B0%86%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E6%88%90%E8%8B%B1%E6%96%87">2. 利用百度翻译API将中文翻译成英文</a></li>
<li><a href="#3-%E5%B0%86%E5%BE%85%E7%BF%BB%E8%AF%91%E4%B8%AD%E6%96%87markdown%E8%BD%AC%E6%8D%A2%E4%B8%BAutf-8%E7%BC%96%E7%A0%81">3. 将待翻译中文markdown转换为<code>utf-8</code>编码</a></li>
<li><a href="#4-%E8%A7%A3%E6%9E%90markdown%E6%96%87%E4%BB%B6%E5%B0%86%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E6%88%90%E8%8B%B1%E6%96%87">4. 解析markdown文件将中文翻译成英文</a></li>
<li><a href="#5-%E5%85%A8%E9%83%A8%E4%BB%A3%E7%A0%81">5. 全部代码</a></li>
</ul>
</li>
</ul>

  </div>
</div>

<script>

  let lastTop = 0, lList = [], hList = [], postBody, lastIndex = -1;
  let active = 'active-show', activeClass = 'active-current';
  let tocWrapper = document.querySelector('#toc_wrapper');
  let tocContent = tocWrapper.children[0];
  let autoNumber = tocWrapper && tocWrapper.classList.contains('auto-number');

  function addTocNumber(elem, deep) {
    if (!elem) {
      return;
    }
    let prop = elem.__proto__;

    if (prop === HTMLUListElement.prototype) {
      for (let i = 0; i < elem.children.length; i++) {
        addTocNumber(elem.children[i], deep + (i + 1) + '.');
      }
    } else if (prop === HTMLLIElement.prototype) {
      // 保存li元素
      if (elem.children[0] && elem.children[0].__proto__ === HTMLAnchorElement.prototype) {
        lList.push(elem);
      }
      for (let i = 0; i < elem.children.length; i++) {
        let cur = elem.children[i];
        if (cur.__proto__ === HTMLAnchorElement.prototype) {
          if (autoNumber) {
            cur.text = deep + ' ' + cur.text;
          }
        } else if (cur.__proto__ === HTMLUListElement.prototype) {
          addTocNumber(cur, deep);
        }
      }
    }
  }

  function removeParentActiveClass() {
    let parents = tocContent.querySelectorAll('.' + active)
    parents.forEach(function (elem) {
      elem.classList.remove(active);
    });
  }

  function addActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.add(activeClass);
    }
  }

  function removeActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.remove(activeClass);
    }
  }

  function addActiveLiElemment(elem, parent) {
    if (!elem || elem === parent) {
      return;
    } else {
      if (elem.__proto__ === HTMLLIElement.prototype) {
        elem.classList.add(active);
      }
      addActiveLiElemment(elem.parentElement, parent);
    }
  }

  function showToc() {
    if (tocWrapper) {
      postBody = document.querySelector('#post_body');
      for (let i = 0; i < postBody.children.length; i++) {
        if (postBody.children[i].__proto__ === HTMLHeadingElement.prototype) {
          hList.push(postBody.children[i]);
        }
      }
      if (tocWrapper.classList.contains('compress')) {
        tocContent.classList.add('closed');
      } else if (tocWrapper.classList.contains('no_compress')) {
        tocContent.classList.add('expanded');
      } else {
        if (hList.length > 10) {
          active = 'active-hidden'
          tocContent.classList.add('closed');
        } else {
          tocContent.classList.add('expanded');
        }
      }
    }
  }

  (function () {
    // 处理不是从#一级标题开始目录
    if (tocContent.children.length === 1 && tocContent.children[0].__proto__ === HTMLLIElement.prototype) {
      let con = tocContent.children[0].children[0];
      tocContent.innerHTML = con.innerHTML;
    }
    let markdownItTOC = document.querySelector('.markdownIt-TOC');
    let innerHeight = window.innerHeight;
    markdownItTOC.style = `max-height: ${innerHeight - 80 > 0 ? innerHeight - 80 : innerHeight}px`
    addTocNumber(tocContent, '');
  })();

  document.addEventListener('scroll', function (e) {
    if (lList.length <= 0) {
      return;
    }
    let scrollTop = document.scrollingElement.scrollTop + 10;
    let dir;

    if (lastTop - scrollTop > 0) {
      dir = 'up';
    } else {
      dir = 'down';
    }

    lastTop = scrollTop;
    if (scrollTop <= 0) {
      if (lastIndex >= 0 && lastIndex < hList.length) {
        lList[lastIndex].classList.remove(activeClass);
      }
      return;
    }

    let current = 0, hasFind = false;
    for (let i = 0; i < hList.length; i++) {
      if (hList[i].offsetTop > scrollTop) {
        current = i;
        hasFind = true;
        break;
      }
    }
    if (!hasFind && scrollTop > lList[lList.length - 1].offsetTop) {
      current = hList.length - 1;
    } else {
      current--;
    }
    if (dir === 'down') {
      if (current > lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex)
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    } else {
      if (current < lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex);
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    }
  });


  window.addEventListener('load', function () {
    showToc();
    document.querySelector('#sidebar').style = 'display: block;';
    tocWrapper.classList.add('toc-active');
    setTimeout(function () {
      if ("createEvent" in document) {
        let evt = document.createEvent("HTMLEvents");
        evt.initEvent("scroll", false, true);
        document.dispatchEvent(evt);
      }
      else {
        document.fireEvent("scroll");
      }
    }, 500)
  })

</script>
            </div>
          
        
      </div>
    </div>
  
</div>
<script>
  const SIDEBAR_TITLE_ACTIVE = 'sidebar-title-active';
  const SIDEBAR_BODY_ACTIVE = 'sidebar-body-active';
  const SLIDE_UP_IN = 'slide-up-in';

  let sidebar = document.querySelector('#sidebar'),
  tocSideBar = document.querySelector('#tocSideBar'),
  metaSideBar = document.querySelector('#metaSideBar'),
  postToc = document.querySelector('#post_toc'),
  postSiteMeta = document.querySelector('#post_side_meta'),
  sidebarTitle = document.querySelector('.sidebar-title'),
  sidebarBody = document.querySelector('#sidebar_body');

  tocSideBar && tocSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  metaSideBar && metaSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  function toggleSidebar(e) {
    let currentTitle = document.querySelector("."+SIDEBAR_TITLE_ACTIVE);
    if (currentTitle == e.srcElement) {
      return ;
    }
    let current, showElement, hideElement;
    if (e.srcElement == metaSideBar) {
      showElement = postSiteMeta;
      hideElement = postToc;
    } else if (e.srcElement == tocSideBar){
      showElement = postToc;
      hideElement = postSiteMeta;
    }
    currentTitle.classList.remove(SIDEBAR_TITLE_ACTIVE);
    e.srcElement.classList.add(SIDEBAR_TITLE_ACTIVE);

    window.Velocity(hideElement, 'stop');
    window.Velocity(hideElement, 'transition.slideUpOut', {
      display: 'none',
      duration: 200,
      complete: function () {
        window.Velocity(showElement, 'transition.slideDownIn', {
          duration: 200
        });
      }
    })
    hideElement.classList.remove(SIDEBAR_BODY_ACTIVE);
    showElement.classList.add(SIDEBAR_BODY_ACTIVE);
  }

  postToc && postToc.addEventListener('transitionend', function() {
    this.classList.remove(SLIDE_UP_IN);
  });

  if (sidebarBody) {
    if (sidebarBody.classList.contains('pisces') || sidebarBody.classList.contains('gemini')) {
      let hasFix = false;
      let scrollEl = document.querySelector('.main-continer');
      let limitTop = document.querySelector('#nav_ul').children.length * 42 + 162;
      window.addEventListener('scroll', function(e) {
        if (document.scrollingElement.scrollTop >= limitTop) {
          if (!hasFix) {
            sidebar.classList.add('sidebar-fixed');
            hasFix = true;
          }
        } else {
          if (hasFix) {
            sidebar.classList.remove('sidebar-fixed');
            hasFix = false;
          }
        }
      });
    }
  }
  
</script>
        <div class="section-box box-shadow-wrapper">
          <div class="section bg-color post post-page">
            <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://tianbaojie.github.io/post/ru-he-you-ya-de-jiang-zhong-wen-markdown-wen-jian-zhuan-huan-wei-ying-wen-markdown-wen-jian/">
      如何优雅的将中文markdown文件转换为英文markdown文件
    </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">发布于</span>
      <span class="publish-time" data-t="2021-01-08 21:34:24">2021-01-08</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span>8<span class="language" data-lan="minute">分钟</span></span>
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span>1585<span class="pc-show language" data-lan="words">字数</span></span>
    </span>
    
  </div>
</section>
            <div class="post-body next-md-body" id="post_body">
              <pre><code>本文主要是讲述将一个用中文写的markdown文件原格式转换为英文写的markdown文件（或者其他两种语言的互译），以解决语言鸿沟。
</code></pre>
<h2 id="1-注册成为百度翻译开发者">1. 注册成为百度翻译开发者</h2>
<p>​	翻译网站有很多，相谷歌翻译、百度翻译、<a href="https://www.deepl.com/translator">DeepL</a>。DeepL作为后起之秀表现很出色，笔者用DeepL翻译word文档能够很好的解决乱码问题。笔者强烈推荐使用DeepL翻译文档而不是谷歌翻译。但是对于笔者想要中文翻译成英文来说，百度作为中文最大的搜索引擎，显然拥有最大的中文语料库，在中文翻译成英语任务表现上更为优秀。</p>
<img src="https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108202120406.png" alt="image-20210108202120406" style="zoom:50%;" />
<p>点击进入<a href="http://api.fanyi.baidu.com/">百度翻译</a>注册成为开发者，由于笔者从事科技行业，百度的垂直领域翻译显然是最好的选择.</p>
<img src="https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108202920713.png" alt="image-20210108202920713" style="zoom:50%;" />
<figure data-type="image" tabindex="1"><img src="https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203238713.png" alt="image-20210108203238713" loading="lazy"></figure>
<p>注册成功后，点击右上角，选择开发者信息。</p>
<img src="https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203047605.png" alt="image-20210108203047605" style="zoom:50%;" />
<p>我们会看到自己的id和密钥，后面会用到</p>
<figure data-type="image" tabindex="2"><img src="https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203353568.png" alt="image-20210108203353568" loading="lazy"></figure>
<h2 id="2-利用百度翻译api将中文翻译成英文">2. 利用百度翻译API将中文翻译成英文</h2>
<p>​	我们除了可以将中文翻译成中文翻译成英文，我们也可以实现其他语言的互译，具体可以参照其官方的<a href="http://api.fanyi.baidu.com/doc/21">文档</a>。</p>
<img src="https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203732994.png" alt="image-20210108203732994" style="zoom:80%;" />
<p>函数<code>translet2english(q)</code>,<code>q</code>是待翻译中文字符串，不超过2000个字符，不含有换行符，使用<code>utf-8</code>编码，函数返回反应后的英文字符串</p>
<pre><code class="language-python">#百度垂直领域翻译API,不包含词典、tts语音合成等资源，如有相关需求请联系translate_api@baidu.com
# 2020.07.28 更新，原url拼接错误，感谢热心网友指正
# coding=utf-8
#http://api.fanyi.baidu.com/doc/22
import http.client
import hashlib
import urllib
import random
import json
import re
def translet2english(q):
    # 你的APP ID，请修改成您的
    appid = '2021010700066xxxx'
    # 你的密钥,请修改成您的
    secretKey = 'My7cCx368vqBmauExxxx'
    # 百度翻译 API 的 HTTP 接口
    myurl = 'http://api.fanyi.baidu.com/api/trans/vip/fieldtranslate'
    httpClient = None


    fromLang = 'auto'   #原文语种
    toLang = 'en'   #译文语种
    salt = random.randint(32768, 65536)

    domain = 'electronics'
    sign = appid + q + str(salt) + domain + secretKey
    sign = hashlib.md5(sign.encode()).hexdigest()
    myurl = myurl + '?appid=' + appid + '&amp;q=' + urllib.parse.quote(q) + '&amp;from=' + fromLang + '&amp;to=' + toLang + '&amp;salt=' + str(salt) + '&amp;domain=' + domain + '&amp;sign=' + sign

    try:
        httpClient = http.client.HTTPConnection('api.fanyi.baidu.com')
        httpClient.request('GET', myurl)

        # response是HTTPResponse对象
        response = httpClient.getresponse()
        result_all = response.read().decode(&quot;utf-8&quot;)
        result = json.loads(result_all)

        #print (result)
        return result['trans_result'][0]['dst']

    except Exception as e:
        print ('error')
    finally:
        if httpClient:
            httpClient.close()
</code></pre>
<h2 id="3-将待翻译中文markdown转换为utf-8编码">3. 将待翻译中文markdown转换为<code>utf-8</code>编码</h2>
<p><code>changeFileType(filename_in,filename_out='C:\\Users\\19532\\Desktop\\testout.md')</code>:将<code>filename_in</code>转换为<code>utf-8</code>编码的<code>filename_out</code>，返回<code>filename_out</code></p>
<p><code>filename_in</code>:待转换的文件</p>
<p><code>filename_out</code>:转换后的文件</p>
<pre><code class="language-python"># _*_ coding: utf-8 _*_
import pandas as pd
import chardet
import codecs
def checkFileType(filename):
    try:
        with open(filename, 'rb') as f:
            data = f.read()
            encoding_type = chardet.detect(data)
            return encoding_type['encoding']
    except Exception as e:
        return 'utf-8'
def changeFileType(filename_in,filename_out='C:\\Users\\19532\\Desktop\\testout.md'): 
    # 输入文件的编码类型
    encode_in = checkFileType(filename_in)
    # 输出文件的编码类型
    encode_out = 'utf-8'
    with codecs.open(filename=filename_in, mode='rb', encoding=encode_in, errors='ignore') as fi:
        data = fi.read()
        with open(filename_out, mode='w', encoding=encode_out) as fo:
            fo.write(data)
            fo.close()
    return filename_out
</code></pre>
<h2 id="4-解析markdown文件将中文翻译成英文">4. 解析markdown文件将中文翻译成英文</h2>
<p><code>findPos(contends)</code>:找到<code>contends</code>字符串中的不能翻译的markdown标记符和不能翻译的代码、公式等等。</p>
<p>markdown标记符参考自<a href="https://www.baidu.com/link?url=wB-lvVgNO8rtuaF2jccRqv9u4ioPZD-RMSr_dxLdLgK9rXmtGfGHeHGI_IkUmbouNkq1SKnarsbuuKNAcSBYz_&amp;wd=&amp;eqid=fa9cf6c9000e73ab000000035ff85583">菜鸟教程</a></p>
<pre><code class="language-python"># 获取文件的内容
def get_contends(path):
    with open(path,'r',encoding='utf-8', errors='ignore') as file_object:
        contends = file_object.read()
    return contends
# 找到markdown标记符
def findPos(contends):
    pattern = re.compile(r'(-+--|#+ |\$[^\$]+\$|\$\$[^\$]+\$\$|\[|\]|\([^\)]+\)|_+|\*+ |\++ |&gt;+ |`[^`]+`|```[^`]+```|\|+|\n+|---[^-]+---|&lt;[^&gt;]*&gt;)',re.DOTALL)
    pos=[]
    def double(matched):
        pos.append(matched.span())
    re.sub(pattern, double,contends)
    return pos
</code></pre>
<p><code>trans2english(contends,pos)</code>:将字符串中除了<code>findPos(contends)</code>找到的不能翻译的字符串所在位置之外的位置的字符串翻译成英文</p>
<pre><code class="language-python">def trans2english(contends,pos):
    l=0
    r=0
    i=0
    eng=''
    while r&lt;len(contends) and i&lt;len(pos):
        a=pos[i][0]
        b=pos[i][1]
        if l&lt;a:
            r=a
            if contends[l:r]!=' ':
                eng+=translet2english(contends[l:r])
            else:
                eng+=contends[l:r]
            l=r
        else:
            l=b
            r=b
            eng+=contends[a:b]
            i=i+1
    if r&lt;len(contends):
        if contends[r:len(contends)]!=' ':
            eng+=translet2english(contends[r:len(contends)])
        else:
             eng+=contends[r:len(contends)]
    return eng
</code></pre>
<p><code>readAndTranslate(fileIn,filename_out)</code>:将<code>fileIn</code>翻译为<code>filename_out</code></p>
<pre><code class="language-python">def readAndTranslate(fileIn='C:\\Users\\19532\\Desktop\\Myblog\\posts\\about.md',filename_out='C:\\Users\\19532\\Desktop\\testenglish.md'):
    filename=changeFileType(fileIn)
    contends=get_contends(filename)
    pos=findPos(contends)
    ans=trans2english(contends,pos)
    with open(filename_out, mode='w', encoding= 'utf-8') as fo:
            fo.write(ans)
            fo.close()
    return ans
</code></pre>
<h2 id="5-全部代码">5. 全部代码</h2>
<pre><code class="language-python">import pandas as pd
import chardet
import codecs
import http.client
import hashlib
import urllib
import random
import json
import re
def translet2english(q):
    # 你的APP ID
    appid = '2021010700066xx'
    # 你的密钥
    secretKey = 'My7cCx368vqBmauE1Bxxxx'
    # 百度翻译 API 的 HTTP 接口
    myurl = 'http://api.fanyi.baidu.com/api/trans/vip/fieldtranslate'
    httpClient = None


    fromLang = 'auto'   #原文语种
    toLang = 'en'   #译文语种
    salt = random.randint(32768, 65536)

    domain = 'electronics'
    sign = appid + q + str(salt) + domain + secretKey
    sign = hashlib.md5(sign.encode()).hexdigest()
    myurl = myurl + '?appid=' + appid + '&amp;q=' + urllib.parse.quote(q) + '&amp;from=' + fromLang + '&amp;to=' + toLang + '&amp;salt=' + str(salt) + '&amp;domain=' + domain + '&amp;sign=' + sign

    try:
        httpClient = http.client.HTTPConnection('api.fanyi.baidu.com')
        httpClient.request('GET', myurl)

        # response是HTTPResponse对象
        response = httpClient.getresponse()
        result_all = response.read().decode(&quot;utf-8&quot;)
        result = json.loads(result_all)

        #print (result)
        return result['trans_result'][0]['dst']

    except Exception as e:
        print ('error')
    finally:
        if httpClient:
            httpClient.close()


def checkFileType(filename):
    try:
        with open(filename, 'rb') as f:
            data = f.read()
            encoding_type = chardet.detect(data)
            return encoding_type['encoding']
    except Exception as e:
        return 'utf-8'
def changeFileType(filename_in,filename_out='C:\\Users\\19532\\Desktop\\testout.md'): 
    # 输入文件的编码类型
    encode_in = checkFileType(filename_in)
    # 输出文件的编码类型
    encode_out = 'utf-8'
    with codecs.open(filename=filename_in, mode='rb', encoding=encode_in, errors='ignore') as fi:
        data = fi.read()
        with open(filename_out, mode='w', encoding=encode_out) as fo:
            fo.write(data)
            fo.close()
    return filename_out
 # 获取文件的内容
def get_contends(path):
    with open(path,'r',encoding='utf-8', errors='ignore') as file_object:
        contends = file_object.read()
    return contends

def findPos(contends):
    pattern = re.compile(r'(-+--|#+ |\$[^\$]+\$|\$\$[^\$]+\$\$|\[|\]|\([^\)]+\)|_+|\*+ |\++ |&gt;+ |`[^`]+`|```[^`]+```|\|+|\n+|---[^-]+---|&lt;[^&gt;]*&gt;)',re.DOTALL)
    pos=[]
    def double(matched):
        pos.append(matched.span())
    re.sub(pattern, double,contends)
    return pos



def trans2english(contends,pos):
    l=0
    r=0
    i=0
    eng=''
    while r&lt;len(contends) and i&lt;len(pos):
        a=pos[i][0]
        b=pos[i][1]
        if l&lt;a:
            r=a
            if contends[l:r]!=' ':
                eng+=translet2english(contends[l:r])
            else:
                eng+=contends[l:r]
            l=r
        else:
            l=b
            r=b
            eng+=contends[a:b]
            i=i+1
    if r&lt;len(contends):
        if contends[r:len(contends)]!=' ':
            eng+=translet2english(contends[r:len(contends)])
        else:
             eng+=contends[r:len(contends)]
    return eng


def readAndTranslate(fileIn='C:\\Users\\19532\\Desktop\\Myblog\\typora\\如何优雅的将中文markdown文件转换为英文markdown文件.md',filename_out='C:\\Users\\19532\\Desktop\\Myblog\\typora\\如何优雅的将中文markdown文件转换为英文markdown文件eng.md'):
    filename=changeFileType(fileIn)
    contends=get_contends(filename)
    pos=findPos(contends)
    ans=trans2english(contends,pos)
    with open(filename_out, mode='w', encoding= 'utf-8') as fo:
            fo.write(ans)
            fo.close()

if __name__ == '__main__':
    fileIn='C:\\Users\\19532\\Desktop\\Myblog\\typora\\如何优雅的将中文markdown文件转换为英文markdown文件.md'
    filename_out=fileIn[:-3]+'eng.md'
    readAndTranslate(fileIn,filename_out)
</code></pre>

            </div>
            
              <div class="reward-btn">
                <div class="reward-btn-text">赞赏</div>
              </div>
            
            
              <div class="post-footer">
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong class="language" data-lan="author">本文作者：</strong>
      田宝杰
    </li>
    <li class="post-copyright-link">
      <strong class="language" data-lan="link">本文链接：</strong>
      <a href="https://tianbaojie.github.io/post/ru-he-you-ya-de-jiang-zhong-wen-markdown-wen-jian-zhuan-huan-wei-ying-wen-markdown-wen-jian/" title="如何优雅的将中文markdown文件转换为英文markdown文件">https://tianbaojie.github.io/post/ru-he-you-ya-de-jiang-zhong-wen-markdown-wen-jian-zhuan-huan-wei-ying-wen-markdown-wen-jian/</a>
    </li>
    <li class="post-copyright-license">
      <strong class="language" data-lan="copyright">版权声明： </strong>
      本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！
    </li>
  </ul>
  <div class="tags">
    
  </div>
  <div class="nav">
    <div class="nav-prev">
      
        <i class="fa fa-chevron-left"></i>
        <a class="nav-pc-next" title="How to gracefully convert Chinese markdown files into English markdown files" href="https://tianbaojie.github.io/post/how-to-gracefully-convert-chinese-markdown-files-into-english-markdown-files/">How to gracefully convert Chinese markdown files into English markdown files</a class="nav-pc-next">
        <a class="nav-mobile-prev" title="How to gracefully convert Chinese markdown files into English markdown files" href="https://tianbaojie.github.io/post/how-to-gracefully-convert-chinese-markdown-files-into-english-markdown-files/">上一篇</a>
      
    </div>
    <div class="nav-next">
      
        <a class="nav-pc-next" title="Benchmark" href="https://tianbaojie.github.io/post/Benchmark/">Benchmark</a>
        <a class="nav-mobile-next" title="Benchmark" href="https://tianbaojie.github.io/post/Benchmark/">下一篇</a>
        <i class="fa fa-chevron-right"></i>
      
    </div>
  </div>
</div>
            
            
  

          </div>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <div class="copyright">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | © 2019-2020 Theme By <a
        href="https://github.com/hsxyhao/gridea-theme-next" target="_blank">HsxyHao</a>
    </div>
    <div class="poweredby">
      
    </div>
  </footer>
  
  
  <div class="pisces back-to-top" id="back_to_top">
    <i class="fa fa-arrow-up"></i>
    
    <span class="scrollpercent">
      <span id="back_to_top_text">0</span>%
    </span>
    
  </div>
  
  
  
</div>
<script>

  let sideBarOpen = 'sidebar-open';
  let body = document.body;
  let back2Top = document.querySelector('#back_to_top'),
    back2TopText = document.querySelector('#back_to_top_text'),
    drawerBox = document.querySelector('#drawer_box'),
    rightSideBar = document.querySelector('.sidebar'),
    viewport = document.querySelector('body');

  function scrollAnimation(currentY, targetY) {

    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function (e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });

  window.addEventListener('scroll', function (e) {
    let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });


  let hasCacu = false;
  window.onresize = function () {
    calcuHeight();
  }

  function calcuHeight() {
    // 动态调整站点概览高度
    if (!hasCacu && back2Top.classList.contains('pisces') || back2Top.classList.contains('gemini')) {
      let sideBar = document.querySelector('.sidebar');
      let navUl = document.querySelector('#site_nav');
      sideBar.style = 'margin-top:' + (navUl.offsetHeight + navUl.offsetTop + 15) + 'px;';
      hasCacu = true;
    }
  }
  calcuHeight();

  let open = false, MOTION_TIME = 300, RIGHT_MOVE_DIS = '320px';

  if (drawerBox) {
    let rightMotions = document.querySelectorAll('.right-motion');
    let right = drawerBox.classList.contains('right');

    let transitionDir = right ? "transition.slideRightIn" : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS
      };
      closeProp = {
        paddingRight: '0px'
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS
      };
      closeProp = {
        paddingLeft: '0px'
      };
    }

    drawerBox.onclick = function () {
      open = !open;
      window.Velocity(rightSideBar, 'stop');
      window.Velocity(viewport, 'stop');
      window.Velocity(rightMotions, 'stop');
      if (open) {
        window.Velocity(rightSideBar, {
          width: RIGHT_MOVE_DIS
        }, {
          duration: MOTION_TIME,
          begin: function () {
            window.Velocity(rightMotions, transitionDir, {});
          }
        })
        window.Velocity(viewport, openProp, {
          duration: MOTION_TIME
        });
      } else {
        window.Velocity(rightSideBar, {
          width: '0px'
        }, {
          duration: MOTION_TIME,
          begin: function () {
            window.Velocity(rightMotions, {
              opacity: 0
            });
          }
        })
        window.Velocity(viewport, closeProp, {
          duration: MOTION_TIME
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle('muse-line');
      }
      drawerBox.classList.toggle(sideBarOpen);
    }
  }

  // 链接跳转
  let newWindow = 'true'
  if (newWindow === 'true') {
    let links = document.querySelectorAll('.post-body a')
    links.forEach(item => {
      if (!item.classList.contains('btn')) {
        item.setAttribute("target", "_blank");
      }
    })
  }

  let faSearch = document.querySelector('#fa_search');
  faSearch.addEventListener('click', function () {
    document.querySelector('#search_mask').style = ''
  })

  // 代码高亮
  hljs.initHighlightingOnLoad();
  
  // 离开当前页title变化
  var leaveTitle = "";
  if (leaveTitle) {
    document.addEventListener('visibilitychange', function () {
      if (document.visibilityState == 'hidden') {
        normal_title = document.title;
        document.title = leaveTitle;
      } else {
        document.title = normal_title;
      }
    });
  }

</script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script>
  let images = document.querySelectorAll('.section img');
  console.log(images);
  images.forEach(image => {
    var parent = image.parentElement;
    var next = image.nextElementSibling;
    parent.removeChild(image);
    var aelem = document.createElement('a');
    aelem.href = image.src;
    aelem.dataset['fancybox'] = 'images';
    aelem.dataset['rel'] = 'fancybox-button';
    aelem.classList.add('fancybox');
    aelem.appendChild(image);
    parent.insertBefore(aelem, next);
  })
</script>
    <div class="reward-mask" style="display: none;">
  <div class="reward-relative">
    <span class="close" aria-hidden="true">x</span>
    <div class="reward-body">
      <h2>感谢您的支持，我会继续努力的!</h2>
      <div class="reward-img-box">
        <div style="position: relative; width: 140px; height: 140px;">
          
          
            <img id="zfb" class="reward-img" src="\media\images\custom-zfbImg.jpg" alt="赞赏码">
          
          
            <img id="wx" class="reward-img" src="\media\images\custom-wxImg.jpg" alt="赞赏码">
          
        </div>
      </div>
      <p class="reward-word">扫码打赏，你说多少就多少</p>
      <p class="reward-tip">打开微信扫一扫，即可进行扫码打赏哦</p>
    </div>
    <div class="bottom">
      
      <div id="zfbBtn" class="pay-text">
        支付宝
      </div>
      
      
      <div id="wxBtn" class="pay-text">
        微信支付
      </div>
      
    </div>
  </div>
</div>
<style>
  .reward-mask {
    position: fixed;
    z-index: 99999;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: #00000054;
  }

  .reward-relative {
    position: relative;
    width: 480px;
    text-align: center;
    margin: 0 auto;
    border-radius: 5px;
    background-color: #fff;
    top: 50%;
    margin-top: -205px;
  }

  .reward-relative .close {
    position: absolute;
    right: 10px;
    font-weight: normal;
    font-size: 16px;
    color: #929292;
  }

  .reward-body {
    padding: 40px 20px 20px;
  }

  .bottom {
    display: flex;
  }

  .reward-btn {
    text-align: center;
  }

  .reward-btn-text {
    display: inline-block;
    cursor: pointer;
    width: 60px;
    height: 60px;
    line-height: 60px;
    border-radius: 50%;
    background-color: #ff9734;
    color: #FFF;
    margin-top: 20px;
  }

  .pay-text {
    margin-top: 10px;
    padding: 10px;
    flex: 1;
    transition: all .2s linear;
  }

  .pay-text:hover {
    background-color: #a5a5a536;
  }

  .reward-body h2 {
    padding-top: 10px;
    text-align: center;
    color: #a3a3a3;
    font-size: 16px;
    font-weight: normal;
    margin: 0 0 20px;
  }

  .reward-body h2:after,
  .reward-body h2:before {
    font-family: Arial, Helvetica, sans-serif;
    background: 0 0;
    width: 0;
    height: 0;
    font-style: normal;
    color: #eee;
    font-size: 80px;
    position: absolute;
    top: 20px;
  }

  .reward-body h2:before {
    content: '\201c';
    left: 50px;
  }

  .reward-body h2:after {
    content: '\201d';
    right: 80px;
  }

  .reward-img-box {
    display: inline-block;
    padding: 10px;
    border: 6px solid #ea5f00;
    margin: 0 auto;
    border-radius: 3px;
    position: relative;
  }

  .reward-img {
    position: absolute;
    left: 0px;
    top: 0px;
    width: 100%;
    height: 100%;
  }

  @media (max-width: 767px) {
    .reward-relative {
      height: 100%;
      top: 0px;
      margin-top: 0;
      width: auto;
    }

    .reward-relative .bottom {
      flex-direction: column;
    }

    .reward-relative .pay-text {
      width: 80%;
      margin: 5px auto;
      border: 1px solid silver;
      padding: 6px;
      border-radius: 4px;
    }

    .reward-body h2:after {
      right: 40px;
    }

    .reward-body h2:after,
    .reward-body h2:before {
      font-size: 60px;
    }

    .reward-body h2:before {
      left: 20px;
    }
  }
</style>
<script>
  !function () {
    var mask = document.querySelector('.reward-mask');
    let close = document.querySelector('.reward-relative .close');
    let rewardBtn = document.querySelector('.reward-btn');

    let zfb = document.querySelector('#zfb'),
      wx = document.querySelector('#wx'),
      zfbBtn = document.querySelector('#zfbBtn'),
      wxBtn = document.querySelector('#wxBtn');

    if (zfbBtn && wxBtn) {
      zfbBtn.addEventListener('click', () => {
        window.Velocity(zfb, 'transition.slideLeftIn', {
          duration: 400
        });
        window.Velocity(wx, 'transition.slideRightOut', {
          display: 'none',
          duration: 400
        });
      });

      wxBtn.addEventListener('click', () => {
        window.Velocity(wx, 'transition.slideRightIn', {
          duration: 400
        });
        window.Velocity(zfb, 'transition.slideLeftOut', {
          display: 'none',
          duration: 400
        });
      });
    }

    rewardBtn.addEventListener('click', (e) => {
      window.Velocity(mask, 'transition.slideDownIn', {
        duration: 400
      })
    });

    close.addEventListener('click', (e) => {
      e.preventDefault();
      window.Velocity(mask, 'transition.slideUpOut', {
        duration: 400
      })
    })
  }()
</script>

  </div>
</body>

<div class="search-mask" id="search_mask" style="display: none;">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input id="search" type="text" class="language" data-lan="search" placeholder="搜索">
      </div>
      <i id="close" class="fa fa-times-circle"></i>
    </div>
    <div class="stat-box">
      <span id="stat_count">0</span><span class="language" data-lan="stat">条相关条目，使用了</span><span id="stat_times">0</span><span class="language" data-lan="stat-time">毫秒</span>
      <hr>
    </div>
    <div class="result" id="result">
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://tianbaojie.github.io/post/how-to-gracefully-convert-chinese-markdown-files-into-english-markdown-files/"" data-c="
          &lt;pre&gt;&lt;code&gt;This paper is mainly about converting the original format of a markdown file written in Chinese to a markdown file written in English (or translation between two other languages) to solve the language gap.
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;1-register-as-baidu-translation-developer&#34;&gt;1. Register as Baidu Translation Developer&lt;/h2&gt;
&lt;p&gt;There are many translation websites, like Google Translation, Baidu Translation,&lt;a href=&#34;https://www.deepl.com/translator&#34;&gt;DeepL&lt;/a&gt;.DeepL as a rising star performs very well, the author uses DeepL to translate word documents can solve the problem of scrambling very well.The author strongly recommends using DeepL to translate documents instead of Google to translate them.But for the author who wants to translate Chinese into English, Baidu, as the largest search engine in Chinese, obviously has the largest Chinese corpus and performs better in the task of translating Chinese into English.&lt;/p&gt;
&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108202120406.png&#34; alt=&#34;image-20210108202120406&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;p&gt;Click to enter&lt;a href=&#34;http://api.fanyi.baidu.com/&#34;&gt;Baidu Translate&lt;/a&gt;Registered as a developer, Baidu&#39;s vertical translation is obviously the best choice because the author is engaged in the science and technology industry.&lt;/p&gt;
&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108202920713.png&#34; alt=&#34;image-20210108202920713&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203238713.png&#34; alt=&#34;image-20210108203238713&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;After successful registration, click on the upper right corner to select the developer information.&lt;/p&gt;
&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203047605.png&#34; alt=&#34;image-20210108203047605&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;p&gt;We&#39;ll see our ID and key, which we&#39;ll use later&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203353568.png&#34; alt=&#34;image-20210108203353568&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;2-translate-chinese-into-english-using-baidu-translation-api&#34;&gt;2. Translate Chinese into English using Baidu Translation API&lt;/h2&gt;
&lt;p&gt;In addition to translating Chinese into English, we can also translate other languages with reference to their official&lt;a href=&#34;http://api.fanyi.baidu.com/doc/21&#34;&gt;File&lt;/a&gt;.&lt;/p&gt;
&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203732994.png&#34; alt=&#34;image-20210108203732994&#34; style=&#34;zoom:80%;&#34; /&gt;
&lt;p&gt;function&lt;code&gt;translet2english(q)&lt;/code&gt;,&lt;code&gt;q&lt;/code&gt;Is a Chinese string to be translated, no more than 2000 characters, no line breaks, using&lt;code&gt;utf-8&lt;/code&gt;Encoding, function returns reacted English string&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#百度垂直领域翻译API,不包含词典、tts语音合成等资源，如有相关需求请联系translate_api@baidu.com
# 2020.07.28 更新，原url拼接错误，感谢热心网友指正
# coding=utf-8
#http://api.fanyi.baidu.com/doc/22
import http.client
import hashlib
import urllib
import random
import json
import re
def translet2english(q):
    # 你的APP ID，请修改成您的
    appid = &#39;2021010700066xxxx&#39;
    # 你的密钥,请修改成您的
    secretKey = &#39;My7cCx368vqBmauExxxx&#39;
    # 百度翻译 API 的 HTTP 接口
    myurl = &#39;http://api.fanyi.baidu.com/api/trans/vip/fieldtranslate&#39;
    httpClient = None


    fromLang = &#39;auto&#39;   #原文语种
    toLang = &#39;en&#39;   #译文语种
    salt = random.randint(32768, 65536)

    domain = &#39;electronics&#39;
    sign = appid + q + str(salt) + domain + secretKey
    sign = hashlib.md5(sign.encode()).hexdigest()
    myurl = myurl + &#39;?appid=&#39; + appid + &#39;&amp;amp;q=&#39; + urllib.parse.quote(q) + &#39;&amp;amp;from=&#39; + fromLang + &#39;&amp;amp;to=&#39; + toLang + &#39;&amp;amp;salt=&#39; + str(salt) + &#39;&amp;amp;domain=&#39; + domain + &#39;&amp;amp;sign=&#39; + sign

    try:
        httpClient = http.client.HTTPConnection(&#39;api.fanyi.baidu.com&#39;)
        httpClient.request(&#39;GET&#39;, myurl)

        # response是HTTPResponse对象
        response = httpClient.getresponse()
        result_all = response.read().decode(&amp;quot;utf-8&amp;quot;)
        result = json.loads(result_all)

        #print (result)
        return result[&#39;trans_result&#39;][0][&#39;dst&#39;]

    except Exception as e:
        print (&#39;error&#39;)
    finally:
        if httpClient:
            httpClient.close()
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3-convert-chinese-markdown-toutf-8code&#34;&gt;3. Convert Chinese markdown to&lt;code&gt;utf-8&lt;/code&gt;Code&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;changeFileType(filename_in,filename_out=&#39;C:\\Users\\19532\\Desktop\\testout.md&#39;)&lt;/code&gt;: will&lt;code&gt;filename_in&lt;/code&gt;Convert to&lt;code&gt;utf-8&lt;/code&gt;Coded&lt;code&gt;filename_out&lt;/code&gt;, back&lt;code&gt;filename_out&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;filename_in&lt;/code&gt;: Files to be converted&lt;/p&gt;
&lt;p&gt;&lt;code&gt;filename_out&lt;/code&gt;: converted file&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;# _*_ coding: utf-8 _*_
import pandas as pd
import chardet
import codecs
def checkFileType(filename):
    try:
        with open(filename, &#39;rb&#39;) as f:
            data = f.read()
            encoding_type = chardet.detect(data)
            return encoding_type[&#39;encoding&#39;]
    except Exception as e:
        return &#39;utf-8&#39;
def changeFileType(filename_in,filename_out=&#39;C:\\Users\\19532\\Desktop\\testout.md&#39;): 
    # 输入文件的编码类型
    encode_in = checkFileType(filename_in)
    # 输出文件的编码类型
    encode_out = &#39;utf-8&#39;
    with codecs.open(filename=filename_in, mode=&#39;rb&#39;, encoding=encode_in, errors=&#39;ignore&#39;) as fi:
        data = fi.read()
        with open(filename_out, mode=&#39;w&#39;, encoding=encode_out) as fo:
            fo.write(data)
            fo.close()
    return filename_out
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4-parse-markdown-file-to-translate-chinese-into-english&#34;&gt;4. Parse markdown file to translate Chinese into English&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;findPos(contends)&lt;/code&gt;: Find&lt;code&gt;contends&lt;/code&gt;Untranslatable markdown tags in strings and untranslatable code, formulas, and so on.&lt;/p&gt;
&lt;p&gt;Markdown tags are referenced from&lt;a href=&#34;https://www.baidu.com/link?url=wB-lvVgNO8rtuaF2jccRqv9u4ioPZD-RMSr_dxLdLgK9rXmtGfGHeHGI_IkUmbouNkq1SKnarsbuuKNAcSBYz_&amp;amp;wd=&amp;amp;eqid=fa9cf6c9000e73ab000000035ff85583&#34;&gt;Rookie Bird Tutorial&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;# 获取文件的内容
def get_contends(path):
    with open(path,&#39;r&#39;,encoding=&#39;utf-8&#39;, errors=&#39;ignore&#39;) as file_object:
        contends = file_object.read()
    return contends
# 找到markdown标记符
def findPos(contends):
    pattern = re.compile(r&#39;(-+--|#+ |\$[^\$]+\$|\$\$[^\$]+\$\$|\[|\]|\([^\)]+\)|_+|\*+ |\++ |&amp;gt;+ |`[^`]+`|```[^`]+```|\|+|\n+|---[^-]+---|&amp;lt;[^&amp;gt;]*&amp;gt;)&#39;,re.DOTALL)
    pos=[]
    def double(matched):
        pos.append(matched.span())
    re.sub(pattern, double,contends)
    return pos
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;trans2english(contends,pos)&lt;/code&gt;: except in the string&lt;code&gt;findPos(contends)&lt;/code&gt;A string found outside the location of an untranslatable string is translated into English&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def trans2english(contends,pos):
    l=0
    r=0
    i=0
    eng=&#39;&#39;
    while r&amp;lt;len(contends) and i&amp;lt;len(pos):
        a=pos[i][0]
        b=pos[i][1]
        if l&amp;lt;a:
            r=a
            if contends[l:r]!=&#39; &#39;:
                eng+=translet2english(contends[l:r])
            else:
                eng+=contends[l:r]
            l=r
        else:
            l=b
            r=b
            eng+=contends[a:b]
            i=i+1
    if r&amp;lt;len(contends):
        if contends[r:len(contends)]!=&#39; &#39;:
            eng+=translet2english(contends[r:len(contends)])
        else:
             eng+=contends[r:len(contends)]
    return eng
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;readAndTranslate(fileIn,filename_out)&lt;/code&gt;: will&lt;code&gt;fileIn&lt;/code&gt;Translate to&lt;code&gt;filename_out&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def readAndTranslate(fileIn=&#39;C:\\Users\\19532\\Desktop\\Myblog\\posts\\about.md&#39;,filename_out=&#39;C:\\Users\\19532\\Desktop\\testenglish.md&#39;):
    filename=changeFileType(fileIn)
    contends=get_contends(filename)
    pos=findPos(contends)
    ans=trans2english(contends,pos)
    with open(filename_out, mode=&#39;w&#39;, encoding= &#39;utf-8&#39;) as fo:
            fo.write(ans)
            fo.close()
    return ans
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;5-all-codes&#34;&gt;5. All Codes&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import pandas as pd
import chardet
import codecs
import http.client
import hashlib
import urllib
import random
import json
import re
def translet2english(q):
    # 你的APP ID
    appid = &#39;2021010700066xx&#39;
    # 你的密钥
    secretKey = &#39;My7cCx368vqBmauE1Bxxxx&#39;
    # 百度翻译 API 的 HTTP 接口
    myurl = &#39;http://api.fanyi.baidu.com/api/trans/vip/fieldtranslate&#39;
    httpClient = None


    fromLang = &#39;auto&#39;   #原文语种
    toLang = &#39;en&#39;   #译文语种
    salt = random.randint(32768, 65536)

    domain = &#39;electronics&#39;
    sign = appid + q + str(salt) + domain + secretKey
    sign = hashlib.md5(sign.encode()).hexdigest()
    myurl = myurl + &#39;?appid=&#39; + appid + &#39;&amp;amp;q=&#39; + urllib.parse.quote(q) + &#39;&amp;amp;from=&#39; + fromLang + &#39;&amp;amp;to=&#39; + toLang + &#39;&amp;amp;salt=&#39; + str(salt) + &#39;&amp;amp;domain=&#39; + domain + &#39;&amp;amp;sign=&#39; + sign

    try:
        httpClient = http.client.HTTPConnection(&#39;api.fanyi.baidu.com&#39;)
        httpClient.request(&#39;GET&#39;, myurl)

        # response是HTTPResponse对象
        response = httpClient.getresponse()
        result_all = response.read().decode(&amp;quot;utf-8&amp;quot;)
        result = json.loads(result_all)

        #print (result)
        return result[&#39;trans_result&#39;][0][&#39;dst&#39;]

    except Exception as e:
        print (&#39;error&#39;)
    finally:
        if httpClient:
            httpClient.close()


def checkFileType(filename):
    try:
        with open(filename, &#39;rb&#39;) as f:
            data = f.read()
            encoding_type = chardet.detect(data)
            return encoding_type[&#39;encoding&#39;]
    except Exception as e:
        return &#39;utf-8&#39;
def changeFileType(filename_in,filename_out=&#39;C:\\Users\\19532\\Desktop\\testout.md&#39;): 
    # 输入文件的编码类型
    encode_in = checkFileType(filename_in)
    # 输出文件的编码类型
    encode_out = &#39;utf-8&#39;
    with codecs.open(filename=filename_in, mode=&#39;rb&#39;, encoding=encode_in, errors=&#39;ignore&#39;) as fi:
        data = fi.read()
        with open(filename_out, mode=&#39;w&#39;, encoding=encode_out) as fo:
            fo.write(data)
            fo.close()
    return filename_out
 # 获取文件的内容
def get_contends(path):
    with open(path,&#39;r&#39;,encoding=&#39;utf-8&#39;, errors=&#39;ignore&#39;) as file_object:
        contends = file_object.read()
    return contends

def findPos(contends):
    pattern = re.compile(r&#39;(-+--|#+ |\$[^\$]+\$|\$\$[^\$]+\$\$|\[|\]|\([^\)]+\)|_+|\*+ |\++ |&amp;gt;+ |`[^`]+`|```[^`]+```|\|+|\n+|---[^-]+---|&amp;lt;[^&amp;gt;]*&amp;gt;)&#39;,re.DOTALL)
    pos=[]
    def double(matched):
        pos.append(matched.span())
    re.sub(pattern, double,contends)
    return pos



def trans2english(contends,pos):
    l=0
    r=0
    i=0
    eng=&#39;&#39;
    while r&amp;lt;len(contends) and i&amp;lt;len(pos):
        a=pos[i][0]
        b=pos[i][1]
        if l&amp;lt;a:
            r=a
            if contends[l:r]!=&#39; &#39;:
                eng+=translet2english(contends[l:r])
            else:
                eng+=contends[l:r]
            l=r
        else:
            l=b
            r=b
            eng+=contends[a:b]
            i=i+1
    if r&amp;lt;len(contends):
        if contends[r:len(contends)]!=&#39; &#39;:
            eng+=translet2english(contends[r:len(contends)])
        else:
             eng+=contends[r:len(contends)]
    return eng


def readAndTranslate(fileIn=&#39;C:\\Users\\19532\\Desktop\\Myblog\\typora\\如何优雅的将中文markdown文件转换为英文markdown文件.md&#39;,filename_out=&#39;C:\\Users\\19532\\Desktop\\Myblog\\typora\\如何优雅的将中文markdown文件转换为英文markdown文件eng.md&#39;):
    filename=changeFileType(fileIn)
    contends=get_contends(filename)
    pos=findPos(contends)
    ans=trans2english(contends,pos)
    with open(filename_out, mode=&#39;w&#39;, encoding= &#39;utf-8&#39;) as fo:
            fo.write(ans)
            fo.close()

if __name__ == &#39;__main__&#39;:
    fileIn=&#39;C:\\Users\\19532\\Desktop\\Myblog\\typora\\如何优雅的将中文markdown文件转换为英文markdown文件.md&#39;
    filename_out=fileIn[:-3]+&#39;eng.md&#39;
    readAndTranslate(fileIn,filename_out)
&lt;/code&gt;&lt;/pre&gt;
">How to gracefully convert Chinese markdown files into English markdown files</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://tianbaojie.github.io/post/ru-he-you-ya-de-jiang-zhong-wen-markdown-wen-jian-zhuan-huan-wei-ying-wen-markdown-wen-jian/"" data-c="
          &lt;pre&gt;&lt;code&gt;本文主要是讲述将一个用中文写的markdown文件原格式转换为英文写的markdown文件（或者其他两种语言的互译），以解决语言鸿沟。
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;1-注册成为百度翻译开发者&#34;&gt;1. 注册成为百度翻译开发者&lt;/h2&gt;
&lt;p&gt;​	翻译网站有很多，相谷歌翻译、百度翻译、&lt;a href=&#34;https://www.deepl.com/translator&#34;&gt;DeepL&lt;/a&gt;。DeepL作为后起之秀表现很出色，笔者用DeepL翻译word文档能够很好的解决乱码问题。笔者强烈推荐使用DeepL翻译文档而不是谷歌翻译。但是对于笔者想要中文翻译成英文来说，百度作为中文最大的搜索引擎，显然拥有最大的中文语料库，在中文翻译成英语任务表现上更为优秀。&lt;/p&gt;
&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108202120406.png&#34; alt=&#34;image-20210108202120406&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;p&gt;点击进入&lt;a href=&#34;http://api.fanyi.baidu.com/&#34;&gt;百度翻译&lt;/a&gt;注册成为开发者，由于笔者从事科技行业，百度的垂直领域翻译显然是最好的选择.&lt;/p&gt;
&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108202920713.png&#34; alt=&#34;image-20210108202920713&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203238713.png&#34; alt=&#34;image-20210108203238713&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;注册成功后，点击右上角，选择开发者信息。&lt;/p&gt;
&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203047605.png&#34; alt=&#34;image-20210108203047605&#34; style=&#34;zoom:50%;&#34; /&gt;
&lt;p&gt;我们会看到自己的id和密钥，后面会用到&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203353568.png&#34; alt=&#34;image-20210108203353568&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;2-利用百度翻译api将中文翻译成英文&#34;&gt;2. 利用百度翻译API将中文翻译成英文&lt;/h2&gt;
&lt;p&gt;​	我们除了可以将中文翻译成中文翻译成英文，我们也可以实现其他语言的互译，具体可以参照其官方的&lt;a href=&#34;http://api.fanyi.baidu.com/doc/21&#34;&gt;文档&lt;/a&gt;。&lt;/p&gt;
&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210108203732994.png&#34; alt=&#34;image-20210108203732994&#34; style=&#34;zoom:80%;&#34; /&gt;
&lt;p&gt;函数&lt;code&gt;translet2english(q)&lt;/code&gt;,&lt;code&gt;q&lt;/code&gt;是待翻译中文字符串，不超过2000个字符，不含有换行符，使用&lt;code&gt;utf-8&lt;/code&gt;编码，函数返回反应后的英文字符串&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#百度垂直领域翻译API,不包含词典、tts语音合成等资源，如有相关需求请联系translate_api@baidu.com
# 2020.07.28 更新，原url拼接错误，感谢热心网友指正
# coding=utf-8
#http://api.fanyi.baidu.com/doc/22
import http.client
import hashlib
import urllib
import random
import json
import re
def translet2english(q):
    # 你的APP ID，请修改成您的
    appid = &#39;2021010700066xxxx&#39;
    # 你的密钥,请修改成您的
    secretKey = &#39;My7cCx368vqBmauExxxx&#39;
    # 百度翻译 API 的 HTTP 接口
    myurl = &#39;http://api.fanyi.baidu.com/api/trans/vip/fieldtranslate&#39;
    httpClient = None


    fromLang = &#39;auto&#39;   #原文语种
    toLang = &#39;en&#39;   #译文语种
    salt = random.randint(32768, 65536)

    domain = &#39;electronics&#39;
    sign = appid + q + str(salt) + domain + secretKey
    sign = hashlib.md5(sign.encode()).hexdigest()
    myurl = myurl + &#39;?appid=&#39; + appid + &#39;&amp;amp;q=&#39; + urllib.parse.quote(q) + &#39;&amp;amp;from=&#39; + fromLang + &#39;&amp;amp;to=&#39; + toLang + &#39;&amp;amp;salt=&#39; + str(salt) + &#39;&amp;amp;domain=&#39; + domain + &#39;&amp;amp;sign=&#39; + sign

    try:
        httpClient = http.client.HTTPConnection(&#39;api.fanyi.baidu.com&#39;)
        httpClient.request(&#39;GET&#39;, myurl)

        # response是HTTPResponse对象
        response = httpClient.getresponse()
        result_all = response.read().decode(&amp;quot;utf-8&amp;quot;)
        result = json.loads(result_all)

        #print (result)
        return result[&#39;trans_result&#39;][0][&#39;dst&#39;]

    except Exception as e:
        print (&#39;error&#39;)
    finally:
        if httpClient:
            httpClient.close()
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3-将待翻译中文markdown转换为utf-8编码&#34;&gt;3. 将待翻译中文markdown转换为&lt;code&gt;utf-8&lt;/code&gt;编码&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;changeFileType(filename_in,filename_out=&#39;C:\\Users\\19532\\Desktop\\testout.md&#39;)&lt;/code&gt;:将&lt;code&gt;filename_in&lt;/code&gt;转换为&lt;code&gt;utf-8&lt;/code&gt;编码的&lt;code&gt;filename_out&lt;/code&gt;，返回&lt;code&gt;filename_out&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;filename_in&lt;/code&gt;:待转换的文件&lt;/p&gt;
&lt;p&gt;&lt;code&gt;filename_out&lt;/code&gt;:转换后的文件&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;# _*_ coding: utf-8 _*_
import pandas as pd
import chardet
import codecs
def checkFileType(filename):
    try:
        with open(filename, &#39;rb&#39;) as f:
            data = f.read()
            encoding_type = chardet.detect(data)
            return encoding_type[&#39;encoding&#39;]
    except Exception as e:
        return &#39;utf-8&#39;
def changeFileType(filename_in,filename_out=&#39;C:\\Users\\19532\\Desktop\\testout.md&#39;): 
    # 输入文件的编码类型
    encode_in = checkFileType(filename_in)
    # 输出文件的编码类型
    encode_out = &#39;utf-8&#39;
    with codecs.open(filename=filename_in, mode=&#39;rb&#39;, encoding=encode_in, errors=&#39;ignore&#39;) as fi:
        data = fi.read()
        with open(filename_out, mode=&#39;w&#39;, encoding=encode_out) as fo:
            fo.write(data)
            fo.close()
    return filename_out
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4-解析markdown文件将中文翻译成英文&#34;&gt;4. 解析markdown文件将中文翻译成英文&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;findPos(contends)&lt;/code&gt;:找到&lt;code&gt;contends&lt;/code&gt;字符串中的不能翻译的markdown标记符和不能翻译的代码、公式等等。&lt;/p&gt;
&lt;p&gt;markdown标记符参考自&lt;a href=&#34;https://www.baidu.com/link?url=wB-lvVgNO8rtuaF2jccRqv9u4ioPZD-RMSr_dxLdLgK9rXmtGfGHeHGI_IkUmbouNkq1SKnarsbuuKNAcSBYz_&amp;amp;wd=&amp;amp;eqid=fa9cf6c9000e73ab000000035ff85583&#34;&gt;菜鸟教程&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;# 获取文件的内容
def get_contends(path):
    with open(path,&#39;r&#39;,encoding=&#39;utf-8&#39;, errors=&#39;ignore&#39;) as file_object:
        contends = file_object.read()
    return contends
# 找到markdown标记符
def findPos(contends):
    pattern = re.compile(r&#39;(-+--|#+ |\$[^\$]+\$|\$\$[^\$]+\$\$|\[|\]|\([^\)]+\)|_+|\*+ |\++ |&amp;gt;+ |`[^`]+`|```[^`]+```|\|+|\n+|---[^-]+---|&amp;lt;[^&amp;gt;]*&amp;gt;)&#39;,re.DOTALL)
    pos=[]
    def double(matched):
        pos.append(matched.span())
    re.sub(pattern, double,contends)
    return pos
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;trans2english(contends,pos)&lt;/code&gt;:将字符串中除了&lt;code&gt;findPos(contends)&lt;/code&gt;找到的不能翻译的字符串所在位置之外的位置的字符串翻译成英文&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def trans2english(contends,pos):
    l=0
    r=0
    i=0
    eng=&#39;&#39;
    while r&amp;lt;len(contends) and i&amp;lt;len(pos):
        a=pos[i][0]
        b=pos[i][1]
        if l&amp;lt;a:
            r=a
            if contends[l:r]!=&#39; &#39;:
                eng+=translet2english(contends[l:r])
            else:
                eng+=contends[l:r]
            l=r
        else:
            l=b
            r=b
            eng+=contends[a:b]
            i=i+1
    if r&amp;lt;len(contends):
        if contends[r:len(contends)]!=&#39; &#39;:
            eng+=translet2english(contends[r:len(contends)])
        else:
             eng+=contends[r:len(contends)]
    return eng
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;readAndTranslate(fileIn,filename_out)&lt;/code&gt;:将&lt;code&gt;fileIn&lt;/code&gt;翻译为&lt;code&gt;filename_out&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def readAndTranslate(fileIn=&#39;C:\\Users\\19532\\Desktop\\Myblog\\posts\\about.md&#39;,filename_out=&#39;C:\\Users\\19532\\Desktop\\testenglish.md&#39;):
    filename=changeFileType(fileIn)
    contends=get_contends(filename)
    pos=findPos(contends)
    ans=trans2english(contends,pos)
    with open(filename_out, mode=&#39;w&#39;, encoding= &#39;utf-8&#39;) as fo:
            fo.write(ans)
            fo.close()
    return ans
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;5-全部代码&#34;&gt;5. 全部代码&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import pandas as pd
import chardet
import codecs
import http.client
import hashlib
import urllib
import random
import json
import re
def translet2english(q):
    # 你的APP ID
    appid = &#39;2021010700066xx&#39;
    # 你的密钥
    secretKey = &#39;My7cCx368vqBmauE1Bxxxx&#39;
    # 百度翻译 API 的 HTTP 接口
    myurl = &#39;http://api.fanyi.baidu.com/api/trans/vip/fieldtranslate&#39;
    httpClient = None


    fromLang = &#39;auto&#39;   #原文语种
    toLang = &#39;en&#39;   #译文语种
    salt = random.randint(32768, 65536)

    domain = &#39;electronics&#39;
    sign = appid + q + str(salt) + domain + secretKey
    sign = hashlib.md5(sign.encode()).hexdigest()
    myurl = myurl + &#39;?appid=&#39; + appid + &#39;&amp;amp;q=&#39; + urllib.parse.quote(q) + &#39;&amp;amp;from=&#39; + fromLang + &#39;&amp;amp;to=&#39; + toLang + &#39;&amp;amp;salt=&#39; + str(salt) + &#39;&amp;amp;domain=&#39; + domain + &#39;&amp;amp;sign=&#39; + sign

    try:
        httpClient = http.client.HTTPConnection(&#39;api.fanyi.baidu.com&#39;)
        httpClient.request(&#39;GET&#39;, myurl)

        # response是HTTPResponse对象
        response = httpClient.getresponse()
        result_all = response.read().decode(&amp;quot;utf-8&amp;quot;)
        result = json.loads(result_all)

        #print (result)
        return result[&#39;trans_result&#39;][0][&#39;dst&#39;]

    except Exception as e:
        print (&#39;error&#39;)
    finally:
        if httpClient:
            httpClient.close()


def checkFileType(filename):
    try:
        with open(filename, &#39;rb&#39;) as f:
            data = f.read()
            encoding_type = chardet.detect(data)
            return encoding_type[&#39;encoding&#39;]
    except Exception as e:
        return &#39;utf-8&#39;
def changeFileType(filename_in,filename_out=&#39;C:\\Users\\19532\\Desktop\\testout.md&#39;): 
    # 输入文件的编码类型
    encode_in = checkFileType(filename_in)
    # 输出文件的编码类型
    encode_out = &#39;utf-8&#39;
    with codecs.open(filename=filename_in, mode=&#39;rb&#39;, encoding=encode_in, errors=&#39;ignore&#39;) as fi:
        data = fi.read()
        with open(filename_out, mode=&#39;w&#39;, encoding=encode_out) as fo:
            fo.write(data)
            fo.close()
    return filename_out
 # 获取文件的内容
def get_contends(path):
    with open(path,&#39;r&#39;,encoding=&#39;utf-8&#39;, errors=&#39;ignore&#39;) as file_object:
        contends = file_object.read()
    return contends

def findPos(contends):
    pattern = re.compile(r&#39;(-+--|#+ |\$[^\$]+\$|\$\$[^\$]+\$\$|\[|\]|\([^\)]+\)|_+|\*+ |\++ |&amp;gt;+ |`[^`]+`|```[^`]+```|\|+|\n+|---[^-]+---|&amp;lt;[^&amp;gt;]*&amp;gt;)&#39;,re.DOTALL)
    pos=[]
    def double(matched):
        pos.append(matched.span())
    re.sub(pattern, double,contends)
    return pos



def trans2english(contends,pos):
    l=0
    r=0
    i=0
    eng=&#39;&#39;
    while r&amp;lt;len(contends) and i&amp;lt;len(pos):
        a=pos[i][0]
        b=pos[i][1]
        if l&amp;lt;a:
            r=a
            if contends[l:r]!=&#39; &#39;:
                eng+=translet2english(contends[l:r])
            else:
                eng+=contends[l:r]
            l=r
        else:
            l=b
            r=b
            eng+=contends[a:b]
            i=i+1
    if r&amp;lt;len(contends):
        if contends[r:len(contends)]!=&#39; &#39;:
            eng+=translet2english(contends[r:len(contends)])
        else:
             eng+=contends[r:len(contends)]
    return eng


def readAndTranslate(fileIn=&#39;C:\\Users\\19532\\Desktop\\Myblog\\typora\\如何优雅的将中文markdown文件转换为英文markdown文件.md&#39;,filename_out=&#39;C:\\Users\\19532\\Desktop\\Myblog\\typora\\如何优雅的将中文markdown文件转换为英文markdown文件eng.md&#39;):
    filename=changeFileType(fileIn)
    contends=get_contends(filename)
    pos=findPos(contends)
    ans=trans2english(contends,pos)
    with open(filename_out, mode=&#39;w&#39;, encoding= &#39;utf-8&#39;) as fo:
            fo.write(ans)
            fo.close()

if __name__ == &#39;__main__&#39;:
    fileIn=&#39;C:\\Users\\19532\\Desktop\\Myblog\\typora\\如何优雅的将中文markdown文件转换为英文markdown文件.md&#39;
    filename_out=fileIn[:-3]+&#39;eng.md&#39;
    readAndTranslate(fileIn,filename_out)
&lt;/code&gt;&lt;/pre&gt;
">如何优雅的将中文markdown文件转换为英文markdown文件</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://tianbaojie.github.io/post/Benchmark/"" data-c="
          &lt;h1 id=&#34;benchmark&#34;&gt;Benchmark&lt;/h1&gt;
&lt;h2 id=&#34;image-retrieval-with-multi-modal-query-on-fashion200k&#34;&gt;&lt;a href=&#34;https://paperswithcode.com/sota/image-retrieval-with-multi-modal-query-on&#34;&gt;Image Retrieval with Multi-Modal Query on Fashion200k&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/xthan/fashion-200k&#34;&gt;dataset introduction and download&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;State-of-the-Art&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210105131301705.png&#34; alt=&#34;image-20210105131301705&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;image-retrieval-with-multi-modal-query-on-fashioniq&#34;&gt;&lt;a href=&#34;https://paperswithcode.com/sota/image-retrieval-with-multi-modal-query-on-1&#34;&gt;Image Retrieval with Multi-Modal Query on FashionIQ&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://arxiv.org/abs/1905.12794&#34;&gt;dataset introduction and download&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;State-of-the-Art&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210105132200936.png&#34; alt=&#34;image-20210105132200936&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;compositional-learning-of-image-text-query-for-image-retrieval&#34;&gt;&lt;a href=&#34;https://paperswithcode.com/paper/compositional-learning-of-image-text-query&#34;&gt;Compositional Learning of Image-Text Query for Image Retrieval&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://web.mit.edu/phillipi/Public/states_and_transformations/index.html&#34;&gt;dataset introduction and download&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;State-of-the-Art&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210105133533502.png&#34; alt=&#34;image-20210105133533502&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;cross-modal-retrieval-on-coco-2014text-to-image&#34;&gt;&lt;a href=&#34;https://paperswithcode.com/sota/cross-modal-retrieval-on-coco-2014&#34;&gt;Cross-Modal Retrieval on COCO 2014(text to image)&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.tensorflow.org/datasets/catalog/coco&#34;&gt;dataset introduction and download&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;State-of-the-Art&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210105134303366.png&#34; alt=&#34;image-20210105134303366&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;fashion-gen-the-generative-fashion-dataset-and-challenge&#34;&gt;&lt;a href=&#34;https://arxiv.org/abs/1806.08317&#34;&gt;Fashion-Gen: The Generative Fashion Dataset and Challenge&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://arxiv.org/abs/1806.08317&#34;&gt;dataset introduction and download&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;State-of-the-Art&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/Tianbaojie/myBlogImage/master/image-20210105135357312.png&#34; alt=&#34;image-20210105135357312&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">Benchmark</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://tianbaojie.github.io/post/about/"" data-c="
          &lt;blockquote&gt;
&lt;p&gt;欢迎来到我的小站呀，很高兴遇见你！🤝&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;关于本站&#34;&gt;🏠 关于本站&lt;/h2&gt;
&lt;h2 id=&#34;博主是-田宝杰&#34;&gt;👨‍💻 博主是 田宝杰&lt;/h2&gt;
&lt;h2 id=&#34;兴趣爱好&#34;&gt;⛹ 兴趣爱好&lt;/h2&gt;
&lt;h2 id=&#34;联系我呀&#34;&gt;📬 联系我呀&lt;/h2&gt;
">关于</a>
      </div>
      
    </div>
    <div class="page">
      <div id="page_ul"></div>
    </div>
  </div>
</div>
<script>
  !function () {
    let searchMask = document.querySelector('#search_mask');
    let result = document.querySelector('#result');
    let items = document.querySelectorAll('.item');
    let searchBox = document.querySelector('#search');
    let statCount = document.querySelector('#stat_count');
    let statTimes = document.querySelector('#stat_times');
    let pageUl = document.querySelector('#page_ul');
    let close = document.querySelector('#close');
    
    close.addEventListener('click', function() {
      searchMask.style = 'display: none;'
    })

    let finds = [];
    let contents = [];
    let pageSize = 10;
    items.forEach(item => {
      let a = item.querySelector('a');
      contents.push({
        title: a.innerText,
        details: a.dataset.c,
        link: a.href
      })
      item.remove();
    })

    function insertStr(soure, start, count) {
      let newStr = soure.substr(start, count);
      return soure.slice(0, start) + '<em>' + newStr + '</em>' + soure.slice(start + count);
    }

    pageUl.addEventListener('click', function(event) {
      let target = event.target;
      if (target.__proto__ === HTMLSpanElement.prototype) {
        appendResults(parseInt(target.dataset.i));
      }
    })

    function appendResults(index) {
      let htmlResult = '';
      let start = index || 0;
      let end = Math.min(start + pageSize, finds.length);
      for (let i = start; i < end; i++) {
        const current = finds[i];
        let html = current.title;
        let sum = 0;
        let positions = current.positions;
        positions.forEach(position => {
          html = insertStr(html, position.start + sum, position.count);
          sum += 9;
        })
        htmlResult += `<div class="item"><a class="result-title" href="${current.link}">${html}</a></div>`;
      }
      result.innerHTML = htmlResult;
      pageUl.innerHTML = '';
      let count = finds.length / pageSize;
      let lis = '';
      if (start !== 0) {
        lis += `<span class="fa fa-angle-left" data-i='${start - 1}'></span>`;
      }
      for (let i = 0; i < count; i++) {
        lis += `<span class='${i === start?'current':''}' data-i='${i}'>${i+1}</span>`;     
      }
      if (start+1 < count) {
        lis += `<span class="fa fa-angle-right" data-i='${start+1}'></span>`;  
      }
      pageUl.innerHTML = lis;
    }

    function search(delay) {
      let timer = null
      return function () {
        clearTimeout(timer)
        timer = setTimeout(() => {
          let start = Date.now();
          let segments = searchBox.value.split(' ').filter(c => c != '');
          if (segments.length <= 0) {
            return;
          }
          finds = [];
          let htmlResult = '';
          contents.forEach(content => {
            let title = content.title;
            let positions = [];
            let find = false;
            segments.forEach((segment) => {
              if (content.title.includes(segment)) {
                find = true;
                positions.push({
                  start: content.title.indexOf(segment),
                  count: segment.length
                })
              } else if (content.details.includes(segment)) {
                find = true;
              }
            });
            if (find) {
              finds.push({
                title: content.title,
                link: content.link,
                positions
              });
            }
          })
          appendResults(0);
          statCount.textContent = finds.length;
          statTimes.textContent = Date.now() - start;
        }, delay)
      }
    }
    searchBox.addEventListener('input', search(200));
  }()
</script>

<input hidden id="copy" />
<script>
  !function () {
    let times = document.querySelectorAll('.publish-time');
    for (let i = 0; i < times.length; i++) {
      let date = times[i].dataset.t;
      let time = Math.floor((new Date().getTime() - new Date(date).getTime()) / 1000);
      if (time < 60) {
        str = time + '秒之前';
      } else if (time < 3600) {
        str = Math.floor(time / 60) + '分钟之前';
      } else if (time >= 3600 && time < 86400) {
        str = Math.floor(time / 3600) + '小时之前';
      } else if (time >= 86400 && time < 259200) {
        str = Math.floor(time / 86400) + '天之前';
      } else {
        str = times[i].textContent;
      }
      times[i].textContent = str;
    }
  }();
</script>

<script>
  let language = '';
  if (language !== '') {
    let map = new Map();
    if (language === 'en') {
      map.set('search', 'Search');
      map.set('category', 'Categories');
      map.set('article', 'Articles');
      map.set('tag', 'Tags');
      map.set('top', 'Top');
      map.set('publish', 'published');
      map.set('minute', ' minutes');
      map.set('read-more', 'Read More');
      map.set('view', 'View');
      map.set('words', ' words');
      map.set('category-in', 'category in');
      map.set('preview', 'Meta');
      map.set('index', 'Toc');
      map.set('no-archives', "You haven't created yet");
      map.set('archives', " articles in total");
      map.set('cloud-tags', " tags in total");
      map.set('copyright', "Copyright: ");
      map.set('author', "Author: ");
      map.set('link', "Link: ");
      map.set('leave-message', "Leave a message");
      map.set('format', "Links Format");
      map.set('site-name', "Name: ");
      map.set('site-link', "Link: ");
      map.set('site-desc', "Desc: ");
      map.set('stat', " related results, taking ");
      map.set('stat-time', " ms");
      map.set('site-img', "Image: ");
    }

    if (map.size > 0) {
      let lanElems = document.querySelectorAll('.language');
      lanElems.forEach(elem => {
        let lan = elem.dataset.lan, text = map.get(lan);
        if (elem.__proto__ === HTMLInputElement.prototype) {
          elem.placeholder = text
        } else {
          if (elem.dataset.count) {
            text = elem.dataset.count + text;
          }
          elem.textContent = text;
        }
      })
    }
  }
  //拿来主义(真香)^_^，Clipboard 实现摘自掘金 https://juejin.im/post/5aefeb6e6fb9a07aa43c20af
  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // 判断是不是ios端
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //创建文本元素
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //选择内容
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //复制到剪贴板
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("复制错误！请手动复制！")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === '复制成功') {
        return;
      }
      e.srcElement.textContent = '复制成功';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === '复制成功') {
            elem.textContent = '复制代码'
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = '复制代码';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })

</script>
<script src="/media/js/motion.js"></script>


<script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script>
  var scroll = new SmoothScroll('a[href*="#"]', {
    speed: 200
  });
</script>





</html>